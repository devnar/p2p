<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Real-Time and Secure Peer to Peer Chat" />
    <meta property="og:title" content="Pitopi" />
    <meta property="og:description" content="Real-Time and Secure Peer to Peer Chat" />
    <meta property="og:url" content="https://devnar.github.io/" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://devnar.github.io/pitopi/assets/pitopi.png" />
    <link rel="icon" href="assets/pitopi.png" />
    <link rel="stylesheet" href="assets/style.css" />
    <title>Pitopi</title>
    <!-- Preload critical assets -->
    <link rel="preload" href="assets/notification.mp3" as="audio">
    <link rel="preload" href="https://cdn.socket.io/4.3.2/socket.io.min.js" as="script">
</head>
<body>
    <!-- Left Sidebar -->
    <sidebar left class="open">
        <div class="search">
            <div class="sidebarMenu" onclick="closeSidebar('left')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </div>
            <input id="searchId" placeholder="Kullanıcı ara..." />
        </div>
        
        <div class="online-users-section">
            <div class="online-users-header">
                <h3>Çevrimiçi Kullanıcılar</h3>
                <span class="online-count" id="online-count">0</span>
            </div>
            <div id="onlineUser"></div>
        </div>
    </sidebar>

    <!-- Right Sidebar -->
    <sidebar right class="open">
        <div class="search">
            <div class="profile-header">
                <div class="profile-info">
                    <h3 id="my-name">John Doe</h3>
                    <p id="my-id" dataId="" class="user-id">ID'yi kopyala</p>
                </div>
            </div>
            <div class="sidebarMenu" onclick="closeSidebar('right')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </div>
        </div>
        <div class="sidebar-content">
            <div class="profile-section">
                <div class="profile-menu">
                    <a href="#" class="profile-menu-item" id="upload-pp-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21"/><path d="m14 19.5 3-3 3 3"/><path d="M17 22v-5.5"/><circle cx="9" cy="9" r="2"/></svg>
                        <span>Profil Fotoğrafı Yükle</span>
                    </a>
                    <input type="file" id="upload-pp-input" accept="image/*" style="display: none;" />
                    <a href="#" class="profile-menu-item" id="hide-from-search">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m13.5 8.5-5 5"/><path d="m8.5 8.5 5 5"/><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                        <span>Aramada Gizle</span>
                    </a>
                    <a href="#" class="profile-menu-item" id="logout-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
                        <span>Çıkış Yap</span>
                    </a>
                </div>
            </div>
        </div>
    </sidebar>

    <main>
        <!-- Header -->
        <header>
            <div style="display: flex; flex-direction: row; align-items: center;">
                <div class="sidebarMenu" onclick="openSidebar('left')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12h16"/><path d="M4 18h16"/><path d="M4 6h16"/></svg>
                </div>
                <div class="header-info">
                    <img src="assets/pitopi.png" alt="logo" width="50" height="50">
                </div>
            </div>
            <div class="header-actions">
                <div class="avatar" onclick="openSidebar('right')">
                    <span class="avatar-fallback">
                        <img src="https://pbs.twimg.com/profile_images/1545518896874242055/s8icSRfU_400x400.jpg" id="my-pp" alt="Profile picture">
                    </span>
                    <span class="online-indicator" id="status"></span>
                </div>
            </div>
        </header>

        <!-- Home Page -->
        <div class="homepage" id="homepage">

            <!-- Stories Grid -->
            <div class="home-section">
                <div class="section-header">
                    <h3>Son Hikayeler</h3>
                    <button class="section-action" onclick="document.getElementById('storyInput').click()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>
                        Hikaye Ekle
                    </button>
                </div>
                <div class="stories-container" id="stories-grid">
                    <!-- Stories will be populated here -->
                </div>
            </div>

            <!-- Online Users Grid -->
            <div class="home-section">
                <div class="section-header">
                    <h3>Çevrimiçi Kişiler</h3>
                    <button class="section-action" onclick="openSidebar('left');document.getElementById('searchId').focus();">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg>
                        Ara
                    </button>
                </div>
                <div class="users-grid" id="users-grid">
                    <!-- Users will be populated here -->
                </div>
            </div>

            <!-- Quick Stats 
            <div class="stats-section">
                <div class="stat-card">
                    <div class="stat-number" id="total-online">0</div>
                    <div class="stat-label">Çevrimiçi Kullanıcı</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-stories">0</div>
                    <div class="stat-label">Aktif Hikaye</div>
                </div>
            </div>-->
        </div>

        <!-- Chat Container -->
        <div class="chat-container" id="chat-container" style="display: none;">
            <!-- Chat Header -->
            <div class="chat-header" id="chat-header">
                <div class="chat-user-info">
                    <img id="chat-user-avatar" src="https://pbs.twimg.com/profile_images/1545518896874242055/s8icSRfU_400x400.jpg" alt="User Avatar">
                    <div>
                        <h4 id="chat-user-name"></h4>
                        <span id="chat-user-status">Çevrimiçi</span>
                    </div>
                </div>
                <button class="leave-chat-btn" onclick="leaveChat()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>

            <div class="message-list" id="chat"></div>
        </div>

        <!-- Input Area -->
        <div class="input-container" id="input-container">
            <div class="input-form" id="chat-form">
                <div class="input-wrapper">
                    <input type="text" class="input-field" id="msg" placeholder="Mesaj yazın..." />
                    <label for="fileInput" class="attachment-button">
                        <svg class="icon-small" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13.234 20.252 21 12.3"/><path d="m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486"/></svg>
                    </label>
                </div>
                <button class="send-button" id="send-btn" onclick="sendMessage()" disabled>
                    <svg class="icon-small" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"/><path d="m21.854 2.147-10.94 10.939"/></svg>
                </button>
            </div>
        </div>

        <audio id="notification-sound" src="assets/notification.mp3" preload="auto"></audio>
        <input type="file" id="fileInput" onchange="sendFile()" disabled style="display: none;" />
        <input type="file" id="storyInput" accept="image/*,video/*" style="display: none;" />
    </main>

    <!-- Story Modal -->
    <div class="story-modal" id="story-modal" style="display: none;">
        <div class="story-modal-content">
            <div class="story-header">
                <div class="story-user-info">
                    <img class="story-avatar" id="story-avatar" src="https://pbs.twimg.com/profile_images/1545518896874242055/s8icSRfU_400x400.jpg" alt="">
                    <div>
                        <h4 id="story-username"></h4>
                        <span id="story-time"></span>
                    </div>
                </div>
                <button class="story-close" onclick="closeStoryModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <div class="story-content">
                <img id="story-image" style="display: none;" alt="">
                <video id="story-video" style="display: none;" controls></video>
            </div>
            <div class="story-progress">
                <div class="story-progress-bar" id="story-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Load scripts at the end for better performance -->
    <script defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
    <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"></script>
    <script src="assets/app.js"></script>
</body>
</html>